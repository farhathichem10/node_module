{"version":3,"sources":["../../projects/cfw/src/services/push-notifications.service.ts","../../../projects/cfw/src/index.ts"],"names":["PushNotificationsService","this","permission","isSupported","Notification","prototype","window","requestPermission","_this","status","create","title","options","Observable","obs","error","complete","n","onshow","e","next","notification","event","onclick","onerror","onclose","Injectable","NgModule","args","providers"],"mappings":"0WAWE,SAAAA,IACEC,KAAKC,WAAaD,KAAKE,cAAgBC,aAAaF,WAAa,gBAGnEF,EAAAK,UAAAF,YAAA,WACE,MAAO,iBAAkBG,QAG3BN,EAAAK,UAAAE,kBAAA,WAAA,IAAAC,EAAAP,KACM,iBAAkBK,QACpBF,aAAaG,mBAAkB,SAACE,GAAgB,OAAAD,EAAKN,WAAaO,MAItET,EAAAK,UAAAK,OAAA,SAAOC,EAAeC,GAAtB,IAAAJ,EAAAP,KAEE,OAAO,IAAIY,EAAAA,YAAW,SAACC,GAEf,iBAAkBR,SACtBQ,EAAIC,MAAM,uDACVD,EAAIE,YAGkB,YAApBR,EAAKN,aACPY,EAAIC,MAAM,qEACVD,EAAIE,YAGN,IAAMC,EAAI,IAAIb,aAAaO,EAAOC,GAElCK,EAAEC,OAAS,SAACC,GAAW,OAAAL,EAAIM,KAAK,CAAEC,aAAcJ,EAAGK,MAAOH,KAC1DF,EAAEM,QAAU,SAACJ,GAAW,OAAAL,EAAIM,KAAK,CAAEC,aAAcJ,EAAGK,MAAOH,KAC3DF,EAAEO,QAAU,SAACL,GAAW,OAAAL,EAAIC,MAAM,CAAEM,aAAcJ,EAAGK,MAAOH,KAC5DF,EAAEQ,QAAU,WAAM,OAAAX,EAAIE,yCAtC3BU,EAAAA,yDCGD,iCAHCC,EAAAA,SAAQC,KAAA,CAAC,CACRC,UAAW,CAAC7B","sourcesContent":["import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { PushNotification, Permission } from '../interfaces/push-notification.type';\n\ndeclare const Notification: any;\n\n@Injectable()\nexport class PushNotificationsService {\n\n  permission: Permission;\n\n  constructor() {\n    this.permission = this.isSupported() ? Notification.permission : 'denied';\n  }\n\n  isSupported() {\n    return 'Notification' in window;\n  }\n\n  requestPermission() {\n    if ('Notification' in window) {\n      Notification.requestPermission((status: any) => this.permission = status);\n    }\n  }\n\n  create(title: string, options?: PushNotification): Observable<{notification: Notification, event: any}> {\n\n    return new Observable((obs: any) => {\n\n      if (!('Notification' in window)) {\n        obs.error('Notifications are not available in this environment');\n        obs.complete();\n      }\n\n      if (this.permission !== 'granted') {\n        obs.error(`The user hasn't granted you permission to send push notifications`);\n        obs.complete();\n      }\n\n      const n = new Notification(title, options);\n\n      n.onshow = (e: any) => obs.next({ notification: n, event: e });\n      n.onclick = (e: any) => obs.next({ notification: n, event: e });\n      n.onerror = (e: any) => obs.error({ notification: n, event: e });\n      n.onclose = () => obs.complete();\n    });\n  }\n\n}\n","import {NgModule} from '@angular/core';\nimport {PushNotificationsService} from './services/push-notifications.service';\n\nexport * from './services/push-notifications.service';\nexport * from './interfaces/push-notification.type';\n\n@NgModule({\n  providers: [PushNotificationsService],\n})\nexport class PushNotificationsModule {}\n"]}